pretrained:
  model: beats
  e2e: False
  freezed: True
  extracted_embeddings_dir: ./embeddings

cmt:
  enabled: false              # CMTã‚’æœ‰åŠ¹åŒ–
  phi_clip: 0.5             # ã‚¯ãƒªãƒƒãƒ—ãƒ¬ãƒ™ãƒ«é–¾å€¤ (è«–æ–‡ã§ã¯0.5)
  phi_frame: 0.7            # ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¬ãƒ™ãƒ«é–¾å€¤ (è«–æ–‡ã§ã¯0.7)
  median_filter_size: 7     # ãƒ¡ãƒ‡ã‚£ã‚¢ãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã®ã‚µã‚¤ã‚º (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ7)


training:
  # # ===== è«–æ–‡ãƒ™ãƒ¼ã‚¹ã®Confident Mean Teacherè¨­å®š =====
  
  # # åŸºæœ¬çš„ãªConfident Teacherè¨­å®š
  # use_confident_teacher: true
  # confidence_threshold: 0.8        # åˆæœŸé–¾å€¤ï¼ˆé«˜ã‚ã«è¨­å®šï¼‰
  # dynamic_confidence: true         # å‹•çš„èª¿æ•´æœ‰åŠ¹
  # min_confidence_threshold: 0.6    # æœ€çµ‚é–¾å€¤ï¼ˆé©åº¦ã«ä¸‹ã’ã‚‹ï¼‰
  # confidence_loss_weight: 0.7      # ãƒãƒ©ãƒ³ã‚¹èª¿æ•´ï¼ˆ0.8â†’0.7ï¼‰
  # apply_confidence_to_weak: true   # å¼±äºˆæ¸¬ã«ã‚‚é©ç”¨
  
  # # è«–æ–‡ãƒ™ãƒ¼ã‚¹ã®ä¿¡é ¼åº¦é‡ã¿ä»˜ãä¸€è²«æ€§æå¤±
  # use_paper_consistency_loss: true    # ğŸ”¥ NEW: è«–æ–‡ã®ä¸€è²«æ€§æå¤±
  # consistency_loss_weight: 1.0       # ãƒ•ãƒ¬ãƒ¼ãƒ ä¸€è²«æ€§æå¤±é‡ã¿
  # weak_consistency_weight: 0.5       # ã‚¯ãƒªãƒƒãƒ—ä¸€è²«æ€§æå¤±é‡ã¿
  # include_weak_consistency: true     # ã‚¯ãƒªãƒƒãƒ—ãƒ¬ãƒ™ãƒ«æå¤±å«ã‚€
  
  # # è«–æ–‡ãƒ™ãƒ¼ã‚¹ã®é–¾å€¤å‡¦ç†
  # use_paper_thresholding: true       # ğŸ”¥ NEW: è«–æ–‡ã®é–¾å€¤å‡¦ç†
  # phi_clip: 0.5                      # ã‚¯ãƒªãƒƒãƒ—ãƒ¬ãƒ™ãƒ«é–¾å€¤ Ï†clip
  # phi_frame: 0.5                     # ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¬ãƒ™ãƒ«é–¾å€¤ Ï†frame
  
  # # PSDS1/PSDS2ãƒãƒ©ãƒ³ã‚¹æˆ¦ç•¥
  # balance_psds: true                 # ãƒãƒ©ãƒ³ã‚¹èª¿æ•´æœ‰åŠ¹
  # fp_suppression_strength: 0.1       # FPæŠ‘åˆ¶å¼·åº¦
  # fp_suppression_weight: 0.15        # FPæŠ‘åˆ¶é‡ã¿ï¼ˆ0.1â†’0.15ï¼‰
  # # negative_confidence_boost: 1.2   # ğŸš§ æœªå®Ÿè£…ï¼ˆå°†æ¥çš„ã«è¿½åŠ äºˆå®šï¼‰
  
  # å­¦ç¿’ç‡ã¨ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°ï¼ˆæ—¢å­˜ã®PyTorch Lightningè¨­å®šã‚’ä½¿ç”¨ï¼‰
  # lr_scheduler: cosine            # ğŸš§ æœªå®Ÿè£…ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ã‚’ä½¿ç”¨ï¼‰
  # warmup_epochs: 20               # ğŸš§ æœªå®Ÿè£…ï¼ˆn_epochs_warmupã‚’ä½¿ç”¨ï¼‰
  
  # ãƒãƒƒãƒã‚µã‚¤ã‚ºï¼ˆè«–æ–‡æ¨å¥¨ï¼‰
  batch_size: [12, 6, 6, 12, 24]    # [maestro, synth, strong, weak, unlabel]
  batch_size_val: 24
  
  # Mean Teacherè¨­å®š
  ema_factor: 0.999                 # EMAä¿‚æ•°ï¼ˆæ¨™æº–ï¼‰
  self_sup_loss: bce                # ğŸ”¥ CHANGED: BCEæå¤±ï¼ˆè«–æ–‡æº–æ‹ ï¼‰
  
  # æå¤±é‡ã¿èª¿æ•´
  const_max: 2.5                    # è‡ªå·±æ•™å¸«å­¦ç¿’æœ€å¤§é‡ã¿ï¼ˆ2â†’2.5ï¼‰
  n_epochs_warmup: 30               # ã‚¦ã‚©ãƒ¼ãƒ ã‚¢ãƒƒãƒ—æœŸé–“ï¼ˆ50â†’30ï¼‰
  epoch_decay: 100
  
  # è¨“ç·´åˆ¶å¾¡
  num_workers: 6
  n_epochs: 300           # ã‚¨ãƒãƒƒã‚¯æ•°ï¼ˆ10â†’200ï¼‰
  early_stop_patience: 200           # æ—©æœŸåœæ­¢ï¼ˆ200â†’50ï¼‰
  accumulate_batches: 1
  gradient_clip: 5.0
  
  # æ¤œè¨¼è¨­å®š
  val_thresholds: [0.5]
  n_test_thresholds: 50
  validation_interval: 10           # æ¤œè¨¼é–“éš”çŸ­ç¸®ï¼ˆ10â†’5ï¼‰
  
  # ãƒ‡ãƒ¼ã‚¿åˆ†å‰²
  weak_split: 0.9
  maestro_split: 0.9
  
  # å†ç¾æ€§
  seed: 42
  deterministic: False
  precision: 32
  
  # ãƒ‡ãƒ¼ã‚¿æ‹¡å¼µ
  mixup: soft
  mixup_prob: 0.5
  
  # è©•ä¾¡ãƒ¡ãƒˆãƒªãƒƒã‚¯
  obj_metric_synth_type: intersection
  obj_metric_maestro_type: fmo
  enable_progress_bar: True

scaler:
  statistic: instance
  normtype: minmax
  dims: [1, 2]
  savepath: ./scaler.ckpt

# ãƒ‡ãƒ¼ã‚¿ãƒ‘ã‚¹ï¼ˆæ—¢å­˜è¨­å®šã‚’ãã®ã¾ã¾ä½¿ç”¨ï¼‰
data:
  synth_folder: "/mnt/data/data/dcase/dataset/dcase_synth/audio/train/synthetic21_train/soundscapes_16k/"
  synth_folder_44k: "/mnt/data/data/dcase/dataset/dcase_synth/audio/train/synthetic21_train/soundscapes/"
  synth_tsv:  "/mnt/data/data/dcase/dataset/dcase_synth/metadata/train/synthetic21_train/soundscapes.tsv"
  strong_folder: "/mnt/data/data/dcase/dataset/audio/train/strong_label_real_16k/"
  strong_folder_44k: "/mnt/data/data/dcase/dataset/audio/train/strong_label_real/"
  strong_tsv: "/mnt/data/data/dcase/dataset/metadata/train/audioset_strong.tsv"
  synth_maestro_train: "/mnt/data/data/dcase/dataset/audio/maestro_synth_train_16k"
  synth_maestro_train_44k: "/mnt/data/data/dcase/dataset/audio/maestro_synth_train"
  synth_maestro_tsv: "/mnt/data/data/dcase/dataset/metadata/maestro_synth_train.tsv"
  real_maestro_train_folder: "/mnt/data/data/dcase/dataset/audio/maestro_real_train_16k"
  real_maestro_train_folder_44k: "/mnt/data/data/dcase/dataset/audio/maestro_real_train"
  real_maestro_train_tsv: "/mnt/data/data/dcase/dataset/metadata/maestro_real_train.tsv"
  real_maestro_val_folder: "/mnt/data/data/dcase/dataset/audio/maestro_real_validation_16k"
  real_maestro_val_folder_44k: "/mnt/data/data/dcase/dataset/audio/maestro_real_validation"
  real_maestro_val_tsv: "/mnt/data/data/dcase/dataset/metadata/maestro_real_validation.tsv"
  real_maestro_val_dur: "/mnt/data/data/dcase/dataset/metadata/maestro_real_durations.tsv"
  weak_folder: "/mnt/data/data/dcase/dataset/audio/train/weak_16k/"
  weak_folder_44k: "/mnt/data/data/dcase/dataset/audio/train/weak/"
  weak_tsv: "/mnt/data/data/dcase/dataset/metadata/train/weak.tsv"
  unlabeled_folder: "/mnt/data/data/dcase/dataset/audio/train/unlabel_in_domain_16k/"
  unlabeled_folder_44k: "/mnt/data/data/dcase/dataset/audio/train/unlabel_in_domain/"
  synth_val_folder: "/mnt/data/data/dcase/dataset/audio/validation/synthetic21_validation/soundscapes_16k/"
  synth_val_folder_44k: "/mnt/data/data/dcase/dataset/dcase_synth/audio/validation/synthetic21_validation/soundscapes/"
  synth_val_tsv:  "/mnt/data/data/dcase/dataset/dcase_synth/metadata/validation/synthetic21_validation/soundscapes.tsv"
  synth_val_dur: "/mnt/data/data/dcase/dataset/dcase_synth/metadata/validation/synthetic21_validation/durations.tsv"
  test_folder: "/mnt/data/data/dcase/dataset/audio/validation/validation_16k/"
  test_folder_44k: "/mnt/data/data/dcase/dataset/audio/validation/validation/"
  test_tsv: "/mnt/data/data/dcase/dataset/metadata/validation/validation.tsv"
  test_dur: "/mnt/data/data/dcase/dataset/metadata/validation/validation_durations.tsv"
  eval_folder: "/mnt/data/data/dcase/dataset/audio/eval24_16k"
  eval_folder_44k: "/mnt/data/data/dcase/dataset/audio/eval24"
  audio_max_len: 10
  fs: 16000
  net_subsample: 4

opt:
  lr: 0.001
  
feats:
  n_mels: 128
  n_filters: 2048
  hop_length: 256
  n_window: 2048
  sample_rate: 16000
  f_min: 0
  f_max: 8000

net:
  dropout: 0.2
  rnn_layers: 1
  n_in_channel: 1
  nclass: 27
  attention: True
  n_RNN_cell: 192
  activation: glu
  rnn_type: BGRU
  kernel_size: [3, 3, 3, 3, 3, 3, 3]
  padding: [1, 1, 1, 1, 1, 1, 1]
  stride: [1, 1, 1, 1, 1, 1, 1]
  nb_filters: [ 16, 32, 64, 128, 128, 128, 128 ]
  pooling: [ [ 2, 2 ], [ 2, 2 ], [ 1, 2 ], [ 1, 2 ], [ 1, 2 ], [ 1, 2 ], [ 1, 2 ] ]
  dropstep_recurrent: 0.3
  dropstep_recurrent_len: 16
  use_embeddings: True
  embedding_size: 768
  embedding_type: frame
  aggregation_type: pool1d
  specaugm_t_p: 0.0
  specaugm_t_l: 5
  specaugm_f_p: 0.0
  specaugm_f_l: 10
  median_filter: [3, 9, 9, 5, 5, 5, 9, 7, 11, 9, 7, 3, 9, 13, 7, 1, 13, 3, 13, 7, 5, 5, 1, 13, 17, 13, 15]
